{
  "name": "book-wall",
  "productName": "Book Wall",
  "version": "1.0.0",
  "description": "A simple desktop app to display your book collection",
  "main": "main.js",
  "scripts": {
    "start": "electron .",
    "build": "electron-builder",
    "build:mac": "electron-builder --mac",
    "build:win": "electron-builder --win"
  },
  "keywords": [],
  "author": "",
  "license": "ISC",
  "devDependencies": {
    "electron": "^28.0.0"
  },
  "build": {
    "appId": "com.bookwall.app",
    "productName": "Book Wall",
    "files": [
      "**/*",
      "!data/books.json"
    ],
    "mac": {
      "target": "dmg",
      "icon": "assets/icon.png",
      "category": "public.app-category.lifestyle"
    },
    "win": {
      "target": "nsis",
      "icon": "assets/icon.png"
    }
  },
  "name": "Build and Release",
  "on": {
    "push": {
      "branches": [
        "main"
      ],
      "tags": [
        "v*"
      ]
    }
  },
  "jobs": {
    "build": {
      "runs-on": "${{ matrix.os }}",
      "strategy": {
        "matrix": {
          "os": [
            "macos-latest",
            "windows-latest"
          ]
        }
      },
      "steps": [
        {
          "uses": "actions/checkout@v3"
        },
        {
          "name": "Setup Node.js",
          "uses": "actions/setup-node@v3",
          "with": {
            "node-version": "18"
          }
        },
        {
          "name": "Install dependencies",
          "run": "npm install"
        },
        {
          "name": "Build app",
          "run": "npm run build"
        },
        {
          "name": "Upload artifacts",
          "uses": "actions/upload-artifact@v3",
          "with": {
            "name": "${{ matrix.os }}-build",
            "path": "dist/*.dmg\ndist/*.exe\ndist/*.zip"
          }
        },
        {
          "name": "Create Release",
          "if": "startsWith(github.ref, 'refs/tags/')",
          "uses": "softprops/action-gh-release@v1",
          "with": {
            "files": "dist/*.dmg\ndist/*.exe"
          },
          "env": {
            "GITHUB_TOKEN": "${{ secrets.GITHUB_TOKEN }}"
          }
        }
      ]
    }
  }
}
